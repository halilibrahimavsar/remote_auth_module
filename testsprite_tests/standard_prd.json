{
  "meta": {
    "project": "Remote Auth Module",
    "date": "2026-02-21",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "A multi-platform Firebase-based authentication module for Flutter that provides email, Google, and phone sign-in flows, session recovery, and optional Firestore user synchronization with clean architecture and BLoC patterns.",
  "core_goals": [
    "Provide secure, production-ready authentication (email/password, Google OAuth, phone/SMS) across Web, Mobile, and Desktop.",
    "Offer flexible integration patterns (ready-to-use widgets, manual integration, DI-friendly) for different project needs.",
    "Support smart session recovery and optional Firestore user profile synchronization.",
    "Expose simple REST-like API endpoints for backend-like interactions and for easy testing/mocking."
  ],
  "features": [
    {
      "name": "Email Authentication",
      "description": "Allow users to register and sign in using email and password. Support updating display name and password post-authentication.",
      "user_flows": [
        "POST /auth/register with {email, password} -> Receive 201 with {userId, emailVerified:false} -> POST /auth/login with {email, password} -> Receive 200 with {token, refreshToken} -> PUT /user/display-name with Authorization: Bearer <token> and {displayName} -> Receive 200 with updated displayName",
        "POST /auth/register with {email (already registered), password} -> Receive 409 with {error: 'email_already_exists'}",
        "POST /auth/login with {email, password: incorrect} -> Receive 401 with {error: 'invalid_credentials'}",
        "POST /auth/login with {email, password} for a user with emailVerified:false -> Receive 200 with {token} and flag emailVerificationRequired:true (flow indicates front-end should show verification gate)"
      ]
    },
    {
      "name": "Google Authentication",
      "description": "Sign in using Google OAuth; integrates with native SDKs on mobile and popup on web. Returns application token on success.",
      "user_flows": [
        "POST /auth/google with {id_token} -> Receive 200 with {token, provider: 'google', userId}",
        "POST /auth/google with {id_token: invalid_or_expired} -> Receive 401 with {error: 'invalid_oauth_token'}",
        "POST /auth/google with {platform:web} without proper client configuration (serverClientId missing) -> Receive 400 with {error: 'google_signin_not_configured'}"
      ]
    },
    {
      "name": "Phone Authentication",
      "description": "Verify phone numbers by sending an SMS verification code and confirm the code to sign in.",
      "user_flows": [
        "POST /auth/phone/verify with {phoneNumber} -> Receive 200 with {verificationId, ttlSeconds} indicating SMS sent -> POST /auth/phone/confirm with {verificationId, code} -> Receive 200 with {token, userId}",
        "POST /auth/phone/verify with {phoneNumber: invalid_format} -> Receive 400 with {error: 'invalid_phone_number'}",
        "POST /auth/phone/confirm with {verificationId, code: incorrect} -> Receive 400 with {error: 'invalid_verification_code'}"
      ]
    },
    {
      "name": "Profile Management",
      "description": "Authenticated endpoints to update user profile fields such as display name and password. These require a valid authorization token.",
      "user_flows": [
        "POST /auth/login with {email, password} -> Receive 200 with {token} -> PUT /user/display-name with Authorization: Bearer <token> and {displayName} -> Receive 200 with updated profile",
        "PUT /user/password with Authorization: Bearer <token> and {currentPassword, newPassword} -> Receive 200 indicating password updated",
        "PUT /user/display-name without Authorization header -> Receive 401 with {error: 'unauthorized'}",
        "PUT /user/password with Authorization: Bearer <token> and {currentPassword: wrong, newPassword} -> Receive 403 with {error: 'invalid_current_password'}"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "backend",
    "tech_stack": [
      "Dart",
      "Flutter",
      "Firebase Auth",
      "Cloud Firestore",
      "BLoC"
    ],
    "features": [
      {
        "name": "Email Authentication",
        "description": "Email and password sign-in and registration",
        "files": [
          "lib/src/data/repositories/firebase_auth_repository.dart",
          "lib/src/presentation/bloc/auth_bloc.dart"
        ],
        "endpoints": [
          {
            "method": "POST",
            "path": "/auth/login",
            "description": "Sign in with email and password",
            "auth_required": false
          },
          {
            "method": "POST",
            "path": "/auth/register",
            "description": "Register a new user with email and password",
            "auth_required": false
          }
        ]
      },
      {
        "name": "Google Authentication",
        "description": "Sign in using Google OAuth",
        "files": [
          "lib/src/services/auth_providers.dart"
        ],
        "endpoints": [
          {
            "method": "POST",
            "path": "/auth/google",
            "description": "Sign in with Google",
            "auth_required": false
          }
        ]
      },
      {
        "name": "Phone Authentication",
        "description": "Sign in using phone number and SMS verification",
        "files": [
          "lib/src/services/phone_auth_service.dart"
        ],
        "endpoints": [
          {
            "method": "POST",
            "path": "/auth/phone/verify",
            "description": "Verify phone number and send SMS code",
            "auth_required": false
          },
          {
            "method": "POST",
            "path": "/auth/phone/confirm",
            "description": "Confirm SMS code and sign in",
            "auth_required": false
          }
        ]
      },
      {
        "name": "Profile Management",
        "description": "Update user profile information",
        "files": [
          "lib/src/data/repositories/firebase_auth_repository.dart"
        ],
        "endpoints": [
          {
            "method": "PUT",
            "path": "/user/display-name",
            "description": "Update user display name",
            "auth_required": true
          },
          {
            "method": "PUT",
            "path": "/user/password",
            "description": "Update user password",
            "auth_required": true
          }
        ]
      }
    ],
    "known_limitations": [
      {
        "issue": "Google Sign-In requires native/web configuration",
        "location": "lib/src/services/auth_providers.dart",
        "impact": "May not work in pure test environments without mocking"
      }
    ]
  }
}
